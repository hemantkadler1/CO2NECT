<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Credit Transactions | CO2NECT</title>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">

<style>
body { font-family: 'Poppins', sans-serif; }

.fade-up {
    animation: fadeUp 0.7s ease forwards;
}
@keyframes fadeUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
}
</style>

<script>
function searchTable() {
    let value = document.getElementById("searchBox").value.toLowerCase();
    let rows = document.querySelectorAll("#txnTable tbody tr");

    rows.forEach(r => {
        let farmer = r.getAttribute("data-farmer")?.toLowerCase() || "";
        let credits = r.getAttribute("data-credits")?.toLowerCase() || "";
        let amount = r.getAttribute("data-amount")?.toLowerCase() || "";

        r.style.display =
            farmer.includes(value) ||
            credits.includes(value) ||
            amount.includes(value)
            ? "" : "none";
    });
}
</script>

</head>

<body class="bg-gradient-to-br from-green-50 via-white to-green-100 min-h-screen">

<!-- FLOATING NAVBAR -->
<nav class="fixed top-6 left-1/2 -translate-x-1/2 z-50
    w-[92%] max-w-6xl
    bg-white/70 backdrop-blur-2xl
    rounded-2xl shadow-xl
    border border-green-200">

    <div class="px-8 py-4 flex justify-between items-center">

        <h1 class="text-2xl font-extrabold
            bg-gradient-to-r from-green-600 to-emerald-400
            bg-clip-text text-transparent tracking-wide">
            CO2NECT
        </h1>

        <div class="flex gap-4 font-medium">
            <a href="/industrial_dashboard"
               class="px-4 py-2 rounded-full bg-blue-100 text-blue-700 hover:bg-blue-200 transition">
               ‚Üê Dashboard
            </a>

            <a href="/"
               class="px-4 py-2 rounded-full bg-red-100 text-red-600 hover:bg-red-200 transition">
               Logout
            </a>
        </div>

    </div>
</nav>

<!-- HEADER -->
<section class="pt-40 text-center fade-up">
    <h2 class="text-5xl font-extrabold text-green-700 mb-4">
        Credit Transactions üìä
    </h2>
    <p class="text-gray-600 text-lg">
        Complete history of your carbon credit purchases.
    </p>
</section>

<!-- SEARCH BAR -->
<div class="max-w-6xl mx-auto mt-10 px-6 fade-up">
    <input id="searchBox"
           onkeyup="searchTable()"
           placeholder="Search by farmer, credits, amount..."
           class="w-full px-6 py-4 rounded-full border border-gray-300
           shadow-md focus:ring-2 focus:ring-green-500 outline-none transition">
</div>

<!-- TABLE CONTAINER -->
<div class="max-w-7xl mx-auto mt-10 px-6 fade-up">

    <div class="bg-white/90 backdrop-blur-xl rounded-3xl shadow-2xl p-8 overflow-x-auto">

        <table id="txnTable" class="w-full text-left">

            <thead>
                <tr class="bg-green-700 text-white text-sm uppercase tracking-wider">
                    <th class="p-4">Farmer</th>
                    <th class="p-4">Phone</th>
                    <th class="p-4">Email</th>
                    <th class="p-4 text-center">Credits</th>
                    <th class="p-4 text-center">Amount</th>
                    <th class="p-4 text-center">Payment</th>
                    <th class="p-4">Date</th>
                </tr>
            </thead>

            <tbody class="text-gray-700">

                {% for t in transactions %}
                <tr class="border-b hover:bg-green-50 transition"
                    data-farmer="{{ t.farmer_name }}"
                    data-credits="{{ t.credits }}"
                    data-amount="{{ t.amount }}">

                    <td class="p-4 font-semibold text-green-700">
                        {{ t.farmer_name }}
                    </td>

                    <td class="p-4">
                        {{ t.farmer_phone }}
                    </td>

                    <td class="p-4 text-sm">
                        {{ t.farmer_email }}
                    </td>

                    <td class="p-4 text-center font-bold text-green-600">
                        {{ t.credits }}
                    </td>

                    <td class="p-4 text-center font-semibold">
                        ‚Çπ{{ t.amount }}
                    </td>

                    <td class="p-4 text-center capitalize">
                        <span class="px-3 py-1 rounded-full text-sm
                            {% if t.transaction_type == 'upi' %}
                                bg-blue-100 text-blue-700
                            {% else %}
                                bg-purple-100 text-purple-700
                            {% endif %}">
                            {{ t.transaction_type }}
                        </span>
                    </td>

                    <td class="p-4 text-sm">
                        {{ t.created_at }}
                    </td>

                </tr>
                {% endfor %}

                {% if transactions|length == 0 %}
                <tr>
                    <td colspan="7" class="text-center py-12 text-gray-500">
                        No transactions found.
                    </td>
                </tr>
                {% endif %}

            </tbody>

        </table>

    </div>

</div>

<!-- FOOTER -->
<footer class="bg-gradient-to-br from-green-900 via-emerald-800 to-green-700 text-white text-center py-8 mt-24">
    <p class="text-green-200">
        ¬© 2025 CO2NECT ‚Äî Industrial Carbon Exchange
    </p>
</footer>

</body>
</html>
